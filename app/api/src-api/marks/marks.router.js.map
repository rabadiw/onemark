{"version":3,"file":"marks.router.js","sourceRoot":"E:/Users/Wael/Work/psx/onemark/src-api/src-api/","sources":["src-api/marks/marks.router.ts"],"names":[],"mappings":"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","sourcesContent":["import { Router } from \"express\";\r\nimport { IMarksController } from \"../marks/marks.domain\";\r\nimport { ITracer } from \"../../modules/tracer\"\r\n\r\nimport { MarksListRepo as MarksRepo } from \"../context/file/marks.repo\";\r\nimport { MarksController as Controller } from \"../marks/marks.controller\";\r\n\r\nconst MarksRouteHandler = (controller: IMarksController, tracer: ITracer) => {\r\n\r\n  const router = Router();\r\n\r\n  const handleError = (err, res) => {\r\n    console.log(err.message);\r\n    res.status(400).json({ error: err.message });\r\n  };\r\n\r\n  // middleware that is specific to this router\r\n  router.use(function timeLog(req, res, next) {\r\n    if (tracer) {\r\n      tracer.info(`Time: ${Date.now()} - ${req.method} - body(${JSON.stringify(req.body)})`);\r\n    }\r\n    next();\r\n  });\r\n\r\n  router.route(\"/\")\r\n    .get((req, res) => {\r\n      controller.getAll()\r\n        .then((data) => {\r\n          res.setHeader(\"Content-Type\", \"application/json;charset=utf-8\");\r\n          res.send(data);\r\n        })\r\n        .catch((err) => handleError(err, res));\r\n    })\r\n    .post((req, res) => {\r\n      controller.create(req.body)\r\n        .then((v) => res.send(v))\r\n        .catch((err) => res.sendStatus(400).send(err));\r\n    });\r\n\r\n  router.route(\"/:id\")\r\n    .get((req, res) => {\r\n      controller.get(req.params.id)\r\n        .then((data) => {\r\n          res.setHeader(\"Content-Type\", \"application/json;charset=utf-8\");\r\n          if (!data.data || data.data.length === 0) {\r\n            res.status(404); // not found\r\n          }\r\n          res.send(data);\r\n        })\r\n        .catch((err) => handleError(err, res));\r\n    })\r\n    .delete((req, res) => {\r\n      controller.delete(req.params.id)\r\n        .then(() => res.status(200).json())\r\n        .catch((err) => handleError(err, res));\r\n\r\n    });\r\n\r\n  return router\r\n}\r\n\r\nexport const MarksRouter = (tracer) => {\r\n  return MarksRouteHandler(new Controller(new MarksRepo(tracer)), tracer)\r\n}\r\n"]}